{
  "$schema": "http://apicast.io/policy-v1/schema#manifest#",
  "name": "IP check",
  "summary": "Accepts or denies a request based on the IP.",
  "description": [
    "Accepts or denies requests according to a whitelist or a blacklist of ",
    "IPs. \n",
    "In the configuration, both single IPs (like 172.18.0.1) and CIDR ",
    "ranges (like 172.18.0.0/16) can be used."
  ],
  "version": "builtin",
  "configuration": {
    "type": "object",
    "properties": {
      "check_type": {
        "description": "The type of check to apply",
        "type": "string",
        "oneOf": [
          {
            "enum": ["blacklist"],
            "title": "Block the IPs included in the list"
          },
          {
            "enum": ["whitelist"],
            "title": "Allow only the IPs included in the list"
          }
        ]
      },
      "ips": {
        "description": "List of IPs",
        "type": "array",
        "items": {
          "type": "string"
        }
      },
      "error_msg": {
        "description": "",
        "type": "string",
        "default": "IP address not allowed"
      }
    },
    "required": ["ips", "check_type"]
  }
}
