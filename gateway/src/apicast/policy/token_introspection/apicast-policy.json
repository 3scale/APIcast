{
  "$schema": "http://apicast.io/poolicy-v1/schema#manifest#",
  "name": "OAuth 2.0 Token Introspection",
  "summary": "Configures OAuth 2.0 Token Introspection.",
  "description": 
  ["This policy executes OAuth 2.0 Token Introspection ",
   "(https://tools.ietf.org/html/rfc7662) for every API call."],
  "version": "builtin",
  "configuration": {
    "type": "object",
    "properties": {
      "introspection_url": {
        "description": "Introspection Endpoint URL",
        "type": "string"
      },
      "client_id": {
        "description": "Client ID for the Token Introspection Endpoint",
        "type": "string"
      },
      "client_secret": {
        "description": "Client Secret for the Token Introspection Endpoint",
        "type": "string"
      },
      "max_ttl_tokens": {
        "description": "Max TTL for cached tokens",
        "type": "integer",
        "minimum": 1,
        "maximum": 3600
      },
      "max_cached_tokens": {
        "description": "Max number of tokens to cache",
        "type": "integer",
        "minimum": 0,
        "maximum": 10000
      }
    }
  }
}
